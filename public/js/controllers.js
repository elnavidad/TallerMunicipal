"use strict;";var Brands=function(){function e(){l.url="/admin/brand",l.success=t,Common.validator($("#submitForm"),l);var e=new mPortlet("portlet_1");$("#type").select2({placeholder:"Seleccione tipo",width:"100%"}),e.on("reload",function(){d.ajax.reload()})}function a(){var e=[{data:"brand",title:"Marca del vehículo"},{data:"type",title:"Tipo de marca"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];d=Common.remoteTable($("#table"),"/admin/brand/datatable",e),d.on("click",'[data-action="edit"]',o),d.on("click",'[data-action="delete"]',i)}function t(e){Common.success("Atencion!","Marca del vehículo registrada con exito."),d.ajax.reload()}function o(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/brand/"+e+"/edit").then(function(){var a={url:"/admin/brand/"+e,success:n,error:Common.eHandler,rules:{brand:{required:!0}}};Common.validator($("#modal form"),a)})}function n(){Common.success("Marca del vehículo actualizada con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),d.ajax.reload()}function i(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:r,extras:$(this).data("id")})}function r(e){$.ajax({url:"/admin/brand/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),d.ajax.reload()},error:Common.eHandler})}var d,l={error:Common.eHandler,rules:{brand:{required:!0}}};return{init:function(){e(),a()}}}(),Departments=function(){function e(){var e=[{data:"id",title:"#"},{data:"name",title:"Departamento"},{data:"attendant",title:"Encargado"},{data:"dependency.name",title:"Dependencia"},{data:"created_at",title:"Creado",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",render:Common.tableActions}];d=Common.remoteTable($("#table"),"/admin/department/datatable",e),d.on("click",'[data-action="edit"]',t),d.on("click",'[data-action="delete"]',n),new mPortlet("portlet_1").on("reload",function(){d.ajax.reload()})}function a(){Common.success("Departamento registrado con exito."),$("#table").find("a").tooltip("dispose"),d.ajax.reload()}function t(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/department/"+e+"/edit").then(function(){var a={url:"/admin/department/"+e,success:o,error:Common.eHandler,rules:{name:{required:!0},attendant:{required:!0},dependency_id:{required:!0}}};r($("#modal form")),Common.validator($("#modal form"),a)})}function o(){Common.success("Departamento actualizado con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),r($("#submitForm")),d.ajax.reload()}function n(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:i,extras:$(this).data("id")})}function i(e){$.ajax({url:"/admin/department/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),d.ajax.reload()},error:Common.eHandler})}function r(e){return $.get("/admin/department/dependencies",function(a){a.data||!a.error?e.find("#dependency_id_input").select2({language:"es",width:"100%",allowClear:!0,placeholder:"Seleccione una dependencia",data:$.map(a.data,function(e){return e.text=e.name,e})}):a.error&&Common.error("Error!",a.r)})}var d;return{init:function(){var t={url:"/admin/department",success:a,error:Common.eHandler,rules:{name:{required:!0},attendant:{required:!0},dependency_id:{required:!0}}};Common.validator($("#submitForm"),t),e(),r($("#submitForm"))}}}(),Dependencies=function(){function e(){var e=[{data:"id",title:"#"},{data:"name",title:"Dependencia"},{data:"attendant",title:"Encargado"},{data:"created_at",title:"Creado",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",render:Common.tableActions}];r=Common.remoteTable($("#table"),"/admin/dependency/datatable",e),r.on("click",'[data-action="edit"]',t),r.on("click",'[data-action="delete"]',n),new mPortlet("portlet_1").on("reload",function(){r.ajax.reload()})}function a(){Common.success("Dependencia registrado con exito."),$("#table").find("a").tooltip("dispose"),r.ajax.reload()}function t(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/dependency/"+e+"/edit").then(function(){var a={url:"/admin/dependency/"+e,success:o,error:Common.eHandler,rules:{name:{required:!0},attendant:{required:!0}}};Common.validator($("#modal form"),a)})}function o(){Common.success("Dependencia actualizado con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),r.ajax.reload()}function n(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:i,extras:$(this).data("id")})}function i(e){$.ajax({url:"/admin/dependency/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),r.ajax.reload()},error:Common.eHandler})}var r;return{init:function(){var t={url:"/admin/dependency",success:a,error:Common.eHandler,rules:{name:{required:!0},attendant:{required:!0}}};Common.validator($("#submitForm"),t),e()}}}(),Oils=function(){function e(){c.url="/admin/oil",c.success=o,Common.validator($("#submitForm"),c),new mPortlet("portlet_1").on("reload",function(){l.ajax.reload()})}function a(){var e=[{data:"usage",title:"Para_uso"},{data:"type",title:"Tipo"},{data:"brand.brand",title:"Marca"},{data:"max",title:"Máximo"},{data:"min",title:"Mínimo"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];l=Common.remoteTable($("#table"),"/admin/oil/datatable",e),l.on("click",'[data-action="edit"]',n),l.on("click",'[data-action="delete"]',r)}function t(e){return $.get("/admin/brands/filter/Aceite",function(a){a.data||!a.error?(e.find("#brand_id_input").html("<option></option>"),e.find("#brand_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione una marca",data:$.map(a.data,function(e){return e.text=e.brand,e})})):a.error&&Common.error("Error!",a.r)})}function o(e){Common.success("Atencion!","Aceite registrado con exito."),l.ajax.reload()}function n(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/oil/"+e+"/edit").then(function(){var a={url:"/admin/oil/"+e,success:i,error:Common.eHandler,rules:{usage:{required:!0},type:{required:!0},max:{required:!0,number:!0},min:{required:!0}}};Common.validator($("#modal form"),a)})}function i(){Common.success("Aceite actualizado con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),l.ajax.reload()}function r(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:d,extras:$(this).data("id")})}function d(e){$.ajax({url:"/admin/oil/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),l.ajax.reload()},error:Common.eHandler})}var l,c={error:Common.eHandler,rules:{usage:{required:!0},type:{required:!0},max:{required:!0,number:!0},min:{required:!0,number:!0}}};return{init:function(){e(),a(),t($("#submitForm"))}}}(),OilsIn=function(){function e(){c.url="/admin/oilIn",c.success=o,Common.validator($("#submitForm"),c),new mPortlet("portlet_1").on("reload",function(){l.ajax.reload()})}function a(){var e=[{data:"oil.brand.brand",title:"Aceite"},{data:"qty",title:"Cantidad"},{data:"unit_cost",title:"Costo"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];l=Common.remoteTable($("#table"),"/admin/oilIn/datatable",e),l.on("click",'[data-action="edit"]',n),l.on("click",'[data-action="delete"]',r)}function t(e){return $.get("/admin/oilIn/oils",function(a){a.data||!a.error?(e.find("#oil_id_input").html("<option></option>"),e.find("#oil_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione un aceite",data:$.map(a.data,function(e){return e.text=e.brand.brand,e})})):a.error&&Common.error("Error!",a.r)})}function o(e){Common.success("Atencion!","Entrada de aceite registrada con exito."),l.ajax.reload()}function n(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/oilIn/"+e+"/edit").then(function(){var a={url:"/admin/oilIn/"+e,success:i,error:Common.eHandler,rules:{oil_id:{required:!0},qty:{required:!0,number:!0},unit_cost:{required:!0,number:!0}}};Common.validator($("#modal form"),a)})}function i(){Common.success("Entrada de aceite actualizada con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),l.ajax.reload()}function r(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:d,extras:$(this).data("id")})}function d(e){$.ajax({url:"/admin/oilIn/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),l.ajax.reload()},error:Common.eHandler})}var l,c={error:Common.eHandler,rules:{oil_id:{required:!0},qty:{required:!0,number:!0},unit_cost:{required:!0,number:!0}}};return{init:function(){e(),a(),t($("#submitForm"))}}}(),OilsOut=function(){function e(){m.url="/admin/oilOut",m.success=n,Common.validator($("#submitForm"),m),new mPortlet("portlet_1").on("reload",function(){c.ajax.reload()})}function a(){var e=[{data:"oil.brand.brand",title:"Aceite"},{data:"vehicle.economic_number",title:"Vehiculo"},{data:"qty",title:"Cantidad"},{data:"reason",title:"Razón de salida"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];c=Common.remoteTable($("#table"),"/admin/oilOut/datatable",e),c.on("click",'[data-action="edit"]',i),c.on("click",'[data-action="delete"]',d)}function t(e){return $.get("/admin/oilOut/oils",function(a){a.data||!a.error?(e.find("#oil_id_input").html("<option></option>"),e.find("#oil_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione un aceite",data:$.map(a.data,function(e){return e.text=e.brand.brand,e})})):a.error&&Common.error("Error!",a.r)})}function o(e){return $.get("/admin/oilOut/vehicles",function(a){a.data||!a.error?(e.find("#vehicle_id_input").html("<option></option>"),e.find("#vehicle_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione un vehículo",data:$.map(a.data,function(e){return e.text=e.economic_number,e})})):a.error&&Common.error("Error!",a.r)})}function n(e){Common.success("Atencion!","Salida de aceite registrada con exito."),c.ajax.reload()}function i(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/oilOut/"+e+"/edit").then(function(){var a={url:"/admin/oilOut/"+e,success:r,error:Common.eHandler,rules:{oil_id:{required:!0},vehicle_id:{required:!0},qty:{required:!0,number:!0},unit_cost:{required:!0,number:!0}}};Common.validator($("#modal form"),a)})}function r(){Common.success("Salida de aceite actualizada con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),c.ajax.reload()}function d(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:l,extras:$(this).data("id")})}function l(e){$.ajax({url:"/admin/oilOut/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),c.ajax.reload()},error:Common.eHandler})}var c,m={error:Common.eHandler,rules:{oil_id:{required:!0},vehicle_id:{required:!0},qty:{required:!0,number:!0},reason:{required:!0}}};return{init:function(){e(),a(),t($("#submitForm")),o($("#submitForm"))}}}(),Permisos=function(){function e(e){Common.success("Aviso","Registro actualizado Satisfactoriamente"),i()}function a(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:t,extras:$(this).data("id")})}function t(e){$.ajax({url:"/admin/permission/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),i()},error:Common.eHandler})}function o(a){var t=$(a.delegateTarget).parent().siblings("form");$("[name*='editForm_']").not("[name*='"+t.attr("name")+"']").slideUp(300),$("[name*='editForm_']").not("[name*='"+t.attr("name")+"']").data("validator",null),$("[name*='editForm_']").not("[name*='"+t.attr("name")+"']").unbind("validate"),t.slideToggle(300),$("[name*='editForm_'] [name*='icon_']").each(function(){$(this).hasClass("select2-hidden-accessible")&&$(this).select2("destroy")});var o=t.find('[name="id_menu"]').val();d($(t),e,"/admin/permission/"+o)}function n(){vid=$(this).data("id"),$.ajax({url:"/admin/permission/priority",dataType:"json",method:"POST",data:{_method:"PUT",_token:$("[name='_token']").val(),_method:"PUT",menu:m.nestedSortable("toHierarchy")},success:function(e){i()},error:Common.eHandler})}function i(){$.get("/admin/permission/menu_builder").then(function(e){$("#menu_builder").html(e)}).then(r)}function r(){m=$("ol.sortable").nestedSortable({forcePlaceholderSize:!0,handle:"div.handle",helper:"clone",items:"li.item",opacity:.6,isTree:!0,errorClass:"placeholder-error",placeholder:"placeholder",tabSize:15,tolerance:"pointer",toleranceElement:"> div",maxLevels:3,excludeRoot:!0,expandOnHover:700,startCollapsed:!1,isAllowed:function(e,a,t){return 0!=t.attr("data-type")?(3!=t.attr("data-type")||void 0==a)&&(void 0==a||0!=a.attr("data-type")):0==t.attr("data-type")&&void 0==a},relocate:n}),$(".m-portlet__head-tools").on("click",".disclose",function(){$(this).parent().parent().parent().closest("li").toggleClass("mjs-nestedSortable-collapsed").toggleClass("mjs-nestedSortable-expanded"),$(this).children("i").toggleClass("la-angle-down").toggleClass("la-angle-up")}),$(".m-portlet__head-tools").on("click",".delete",a),$(".m-portlet__head-tools").on("click",".edit",o)}function d(e,a,t){e.find("[name='icon']").select2({minimumInputLength:2,language:"es",ajax:{url:"/admin/permission/icons",dataType:"json",delay:250,type:"GET",data:function(e){return{query:e.term}},processResults:function(e){return{results:e}}},templateResult:c,templateSelection:c});var o={url:t,success:a,error:Common.eHander,rules:{menu:{required:!0,range:[0,3]},title:{required:!0},route:{required:"#type_menu:checked"},icon:{required:"#type_menu:checked"}}};Common.validator(e,o)}function l(){Common.success("Aviso","Registro Exitoso"),i()}function c(e){return $('<div><i style="margin-right: 12px; " class=" '+e.id+' "></i>'+e.text+"</div>")}var m;return{init:function(){i(),d($("#submitForm"),l,"/admin/permission")}}}(),Refections=function(){function e(){c.url="/admin/refection",c.success=o,Common.validator($("#submitForm"),c),new mPortlet("portlet_1").on("reload",function(){l.ajax.reload()})}function a(){var e=[{data:"description",title:"Descripción"},{data:"brand.brand",title:"Marca"},{data:"model",title:"Modelo"},{data:"max",title:"Máximo"},{data:"min",title:"Mínimo"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];l=Common.remoteTable($("#table"),"/admin/refection/datatable",e),l.on("click",'[data-action="edit"]',n),l.on("click",'[data-action="delete"]',r)}function t(e){return $.get("/admin/brands/filter/Refaccion",function(a){a.data||!a.error?(e.find("#brand_id_input").html("<option></option>"),e.find("#brand_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione una marca",data:$.map(a.data,function(e){return e.text=e.brand,e})})):a.error&&Common.error("Error!",a.r)})}function o(e){Common.success("Atencion!","Refacción registrada con exito."),l.ajax.reload()}function n(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/refection/"+e+"/edit").then(function(){var a={url:"/admin/refection/"+e,success:i,error:Common.eHandler,rules:{description:{required:!0},model:{required:!0},max:{required:!0,number:!0},min:{required:!0}}};Common.validator($("#modal form"),a)})}function i(){Common.success("Refacción actualizada con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),l.ajax.reload()}function r(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:d,extras:$(this).data("id")})}function d(e){$.ajax({url:"/admin/refection/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),l.ajax.reload()},error:Common.eHandler})}var l,c={error:Common.eHandler,rules:{description:{required:!0},model:{required:!0},max:{required:!0,number:!0},min:{required:!0,number:!0}}};return{init:function(){e(),a(),t($("#submitForm"))}}}(),RefectionsIn=function(){function e(){c.url="/admin/refectionIn",c.success=o,Common.validator($("#submitForm"),c),new mPortlet("portlet_1").on("reload",function(){l.ajax.reload()})}function a(){var e=[{data:"refection.description",title:"Refacción"},{data:"qty",title:"Cantidad"},{data:"unit_cost",title:"Precio por unidad"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];l=Common.remoteTable($("#table"),"/admin/refectionIn/datatable",e),l.on("click",'[data-action="edit"]',n),l.on("click",'[data-action="delete"]',r)}function t(e){return $.get("/admin/refectionIn/refections",function(a){a.data||!a.error?(e.find("#refection_id_input").html("<option></option>"),e.find("#refection_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione una refacción",data:$.map(a.data,function(e){return e.text=e.description,e})})):a.error&&Common.error("Error!",a.r)})}function o(e){Common.success("Atencion!","Refacción registrada con exito."),l.ajax.reload()}function n(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/refectionIn/"+e+"/edit").then(function(){var a={url:"/admin/refectionIn/"+e,success:i,error:Common.eHandler,rules:{refection_id:{required:!0},qty:{required:!0,number:!0},unit_cost:{required:!0,number:!0}}};Common.validator($("#modal form"),a)})}function i(){Common.success("Refacción actualizada con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),l.ajax.reload()}function r(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:d,extras:$(this).data("id")})}function d(e){$.ajax({url:"/admin/refectionIn/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),l.ajax.reload()},error:Common.eHandler})}var l,c={error:Common.eHandler,rules:{refection_id:{required:!0},qty:{required:!0},unit_cost:{required:!0,number:!0}}};return{init:function(){e(),a(),t($("#submitForm"))}}}(),RefectionsOut=function(){function e(){m.url="/admin/refectionOut",m.success=n,Common.validator($("#submitForm"),m),new mPortlet("portlet_1").on("reload",function(){c.ajax.reload()})}function a(){var e=[{data:"refection.description",title:"Refacción"},{data:"vehicle.economic_number",title:"Vehículo"},{data:"qty",title:"Cantidad"},{data:"reason",title:"Razón de salida"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];c=Common.remoteTable($("#table"),"/admin/refectionOut/datatable",e),c.on("click",'[data-action="edit"]',i),c.on("click",'[data-action="delete"]',d)}function t(e){return $.get("/admin/refectionOut/refections",function(a){a.data||!a.error?(e.find("#refection_id_input").html("<option></option>"),e.find("#refection_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione una refacción",data:$.map(a.data,function(e){return e.text=e.description,e})})):a.error&&Common.error("Error!",a.r)})}function o(e){return $.get("/admin/refectionOut/vehicles",function(a){a.data||!a.error?(e.find("#vehicle_id_input").html("<option></option>"),e.find("#vehicle_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione un vehículo",data:$.map(a.data,function(e){return e.text=e.economic_number,e})})):a.error&&Common.error("Error!",a.r)})}function n(e){Common.success("Atencion!","Salida de Refacción registrada con exito."),c.ajax.reload()}function i(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/refectionOut/"+e+"/edit").then(function(){var a={url:"/admin/refectionOut/"+e,success:r,error:Common.eHandler,rules:{refection_id:{required:!0},vehicle_id:{required:!0},qty:{required:!0,number:!0},reason:{required:!0}}};Common.validator($("#modal form"),a)})}function r(){Common.success("Salida de Refacción actualizada con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),c.ajax.reload()}function d(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:l,extras:$(this).data("id")})}function l(e){$.ajax({url:"/admin/refectionOut/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),c.ajax.reload()},error:Common.eHandler})}var c,m={error:Common.eHandler,rules:{refection_id:{required:!0},vehicle_id:{required:!0},qty:{required:!0,number:!0},reason:{required:!0}}};return{init:function(){e(),a(),t($("#submitForm")),o($("#submitForm"))}}}(),Roles=function(){function e(e){e.find("form").find("input[type='checkbox']").on("change",function(){var a=$(this).prop("checked");$(this).parent().siblings("div").find("input[type='checkbox']").prop("checked",a),e.find("form").find('.access-panel [name*="permisos["]').each(t)}),e.find(".access-panel i").tooltip(),e.find("form").find(".access-panel").popover({title:"Permisos",html:!0,content:$("#role_permission").html()}),e.find("form").find(".access-panel").on("show.bs.popover",function(){e.find("form").find(".access-panel").popover("hide")}),e.find("form").find(".access-panel").on("shown.bs.popover",function(){var t=$(this),o=t.attr("aria-describedby");a(t,$("#"+o),e)}),new mPortlet("portlet_1").on("reload",function(){s.ajax.reload()})}function a(e,a,o){a.on("click",".cancel",function(){e.popover("hide")}),a.on("click","#all",function(){a.find('[type="checkbox"]').prop("checked",!0)}),a.on("click","#none",function(){a.find('[type="checkbox"]').prop("checked",!1)}),e.find("input[type='hidden']").each(function(e,t){a.find("[name='menu["+$(t).attr("id")+"]']").prop("checked","true"===$(t).val())}),a.on("click",".confirm",function(){var n=a.find("form").serializeObject();e.find("input[type='hidden']").val(!1),e.siblings(".m-checkbox-parent").each(function(){$(this).find(".access-panel").each(function(){var e=$(this).siblings("label").children('input[type="checkbox"]');(e.prop("checked")||e.prop("indeterminate"))&&$(this).find("input[type='hidden']").val(!1)})});for(key in n.menu)e.siblings(".m-checkbox-parent").each(function(){$(this).find(".access-panel").each(function(){var e=$(this).siblings("label").children('input[type="checkbox"]');(e.prop("checked")||e.prop("indeterminate"))&&$(this).find("[permission='"+key+"']").val(n.menu[key])})}),e.find("[permission='"+key+"']").val(n.menu[key]);o.find("form").find('.access-panel [name*="permisos["]').each(t),e.popover("hide")})}function t(){var e=$(this),a=e.attr("permission"),t="true"===e.val(),o=e.closest(".access-panel").siblings(".m-checkbox").children('[type="checkbox"]'),n=e.closest(".access-panel").siblings(".m-checkbox-parent"),i=n.find("[permission='"+a+"']").length,r=n.find("[permission='"+a+'\'][value="true"]').length;if(!o.prop("checked")&&!o.prop("indeterminate"))return e.siblings("[data-for]").removeClass("display"),void e.val(!1);i>0&&0===r&&(e.val(!1),t=!1),t?(e.siblings("[data-for='NaN']").removeClass("display"),e.siblings("[data-for='"+a+"']").addClass("display"),i>0&&r!=i?e.siblings("[data-for='"+a+"']").addClass("partial"):e.siblings("[data-for='"+a+"']").removeClass("partial")):(e.siblings("[data-for='"+a+"']").removeClass("display"),0===e.siblings("[data-for].display").not("[data-for='NaN']").length&&e.siblings("[data-for='NaN']").addClass("display"))}function o(){$(".access-panel .la").removeClass("display"),$(".access-panel .la").not(".la-lock").removeClass("partial"),$(".access-panel [type='hidden']").val(!1)}function n(){var e=[{data:"id",title:"#"},{data:"name",title:"Rol"},{data:"description",title:"Descripcion"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"permissions",title:"Permisos",render:function(e){var a="";return $.each(e,function(e,t){0!=e&&(a+=" - "),title="";for(var o in t.pivot)switch(o){case"C":"1"===t.pivot[o]&&(title+="<i class='la la-plus'></i>");break;case"R":"1"===t.pivot[o]&&(title+="<i class='la la-eye'></i>");break;case"U":"1"===t.pivot[o]&&(title+="<i class='la la-edit'></i>");break;case"D":"1"===t.pivot[o]&&(title+="<i class='la la-times'></i>");break;case"admin":"1"===t.pivot[o]&&(title+="<i class='la la-user-plus'></i>")}a+="<a href='javascript:void(0);' data-html='true' class='m-link' title=\""+title+'">'+t.title+"</a>"}),a}},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"active",title:"Estado",render:Common.tableActive},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];s=Common.remoteTable($("#table"),"/admin/role/datatable",e),s.on("click",'[data-action="toggle"]',r),s.on("click",'[data-action="edit"]',d),s.on("click",'[data-action="delete"]',c)}function i(){Common.success("Rol registrado con exito."),$("#table").find("a").tooltip("dispose"),s.ajax.reload()}function r(){$.ajax({url:"/admin/role/"+$(this).data("id")+"/active",method:"POST",data:{_token:$("[name='_token']").val(),_method:"PUT"},dataType:"json",success:function(e){Common.success("Aviso","Registro Actualizado Satisfactoriamente"),$("#table").find("a").tooltip("dispose"),s.ajax.reload()},error:Common.eHandler})}function d(){var a=$(this).data("id");Common.modal($("#modal"),"/admin/role/"+a+"/edit").then(function(){e($("#modal")),$('#modal .access-panel [name*="permisos["]').each(t);var o={url:"/admin/role/"+a,success:l,error:Common.eHandler,rules:{name:{required:!0},state:{required:!0}}};Common.validator($("#modal form"),o)})}function l(){Common.success("Rol actualizado con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),s.ajax.reload()}function c(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:m,extras:$(this).data("id")})}function m(e){$.ajax({url:"/admin/role/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),s.ajax.reload()},error:Common.eHandler})}var s;return{init:function(){var a={url:"/admin/role",success:i,error:Common.eHandler,rules:{name:{required:!0},state:{required:!0}}};Common.validator($("#submitForm"),a,o),e($(".m-content")),n()}}}(),Users=function(){function e(){p.url="/admin/user",p.success=i,Common.validator($("#submitForm"),p),new mPortlet("portlet_1").on("reload",function(){f.ajax.reload()})}function a(){var e=[{data:"username",title:"Usuario"},{data:"name",title:"Nombre"},{data:"email",title:"Correo"},{data:"dependency.name",title:"Dependencia"},{data:"department.name",title:"Departamento"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"role",title:"Rol",render:function(e){return e.name}},{data:"active",title:"Estado",render:Common.tableActive},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];f=Common.remoteTable($("#table"),"/admin/user/datatable",e),f.on("click",'[data-action="toggle"]',m),f.on("click",'[data-action="edit"]',r),f.on("click",'[data-action="delete"]',l)}function t(e){return $.get("/admin/user/roles",function(a){a.data||!a.error?e.find("#role_id_input").select2({language:"es",width:"100%",allowClear:!0,placeholder:"Seleccione un rol",data:$.map(a.data,function(e){return e.text=e.name,1===parseInt(e.active)?e:void 0})}):a.error&&Common.error("Error!",a.r)})}function o(e){return $.get("/admin/user/dependencies",function(a){a.data||!a.error?(e.find("#dependency_id_input").select2({language:"es",width:"100%",allowClear:!0,placeholder:"Seleccione una dependencia",data:$.map(a.data,function(e){return e.text=e.name,e})}),e.find("#dependency_id_input").on("change",function(){n(e,$(this).val())})):a.error&&Common.error("Error!",a.r)})}function n(e,a){return $.get("/admin/user/departments",function(t){if(t.data||!t.error){var o=$.grep(t.data,function(e){return e.dependency_id==a});e.find("#department_id_input").select2("val",""),e.find("#department_id_input").html("<option></option>"),e.find("#department_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione un departamento",data:$.map(o,function(e){return e.text=e.name,e})})}else t.error&&Common.error("Error!",t.r)})}function i(e){Common.success("Atencion!","Usuario registrado con exito."),f.ajax.reload()}function r(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/user/"+e+"/edit").then(function(){t($("#modal")),o($("#modal")).then(function(){$("#modal").find("#dependency_id_input").trigger("change")}),$("#modal").on("hidden.bs.modal",function(){t($("#submitForm")),o($("#submitForm")),$("#submitForm").find("#department_id_input").select2({language:"es",width:"100%",allowClear:!0,placeholder:"Seleccione un departamento"})});var a=$("#modal form #username_input").val(),n=$.extend({},p);n.url="/admin/user/"+e,n.success=d,n.rules.username.remote=function(){return"/admin/user/userexists?before="+a},n.rules.password=function(){return $("#modal form #password_input").val()},n.rules.confirm={equalTo:"#modal form #password_input"},Common.validator($("#modal form"),n)})}function d(){Common.success("Usuario actualizado con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),f.ajax.reload()}function l(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:c,extras:$(this).data("id")})}function c(e){$.ajax({url:"/admin/user/"+e,
method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),f.ajax.reload()},error:Common.eHandler})}function m(){$.ajax({url:"/admin/user/"+$(this).data("id")+"/active",method:"POST",data:{_token:$("[name='_token']").val(),_method:"PUT"},dataType:"json",success:function(e){Common.success("Aviso","Registro Actualizado Satisfactoriamente"),$("#table").find("a").tooltip("dispose"),f.ajax.reload()},error:Common.eHandler})}function s(){Common.modal($("#modal"),"/admin/user/changePassword").then(function(){var e={url:"/admin/user/changePassword",success:u,rules:{password:{required:!0},confirm:{equalTo:"#modal form #password_input"}}};Common.validator($("#modal form"),e)})}function u(){$("#modal").modal("hide"),Common.success("Atencion!","Contraseña actualizada con exito.")}var f,p={error:Common.eHandler,rules:{username:{required:!0,remote:{url:"/admin/user/userexists",type:"get",data:{username:function(){return $("#username_input").val()},company:function(){return $("#company_input").val()}}}},password:{required:!0},confirm:{equalTo:"#password_input"},name:{required:!0},email:{email:!0},role_id:{required:!0},dependency_id:{required:!0},department_id:{required:!0}},customMessages:{username:{remote:"Nombre de usuario ya registrado."}}};return{init:function(){e(),a(),t($("#submitForm")),o($("#submitForm")),$("#submitForm").find("#department_id_input").select2({language:"es",width:"100%",allowClear:!0,placeholder:"Seleccione un departamento"})},changePassword:s}}(),Vehicles=function(){function e(){m.url="/admin/vehicle",m.success=n,Common.validator($("#submitForm"),m),new mPortlet("portlet_1").on("reload",function(){c.ajax.reload()})}function a(){var e=[{data:"dependency.name",title:"Dependencia"},{data:"economic_number",title:"Número Económico"},{data:"plate",title:"Número de Placas"},{data:"serial_number",title:"Número de Serie"},{data:"brand.brand",title:"Marca"},{data:"model",title:"Modelo"},{data:"year",title:"Año"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];c=Common.remoteTable($("#table"),"/admin/vehicle/datatable",e),c.on("click",'[data-action="edit"]',i),c.on("click",'[data-action="delete"]',d)}function t(e){return $.get("/admin/vehicle/dependencies",function(a){a.data||!a.error?(e.find("#dependency_id_input").html("<option></option>"),e.find("#dependency_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione una dependencia",data:$.map(a.data,function(e){return e.text=e.name,e})})):a.error&&Common.error("Error!",a.r)})}function o(e){return $.get("/admin/brands/filter/Vehiculo",function(a){a.data||!a.error?(e.find("#brand_id_input").html("<option></option>"),e.find("#brand_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione una marca",data:$.map(a.data,function(e){return e.text=e.brand,e})})):a.error&&Common.error("Error!",a.r)})}function n(e){Common.success("Atencion!","Vehículo registrado con exito."),c.ajax.reload()}function i(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/vehicle/"+e+"/edit").then(function(){var a={url:"/admin/vehicle/"+e,success:r,error:Common.eHandler,rules:{dependency_id:{required:!0},economic_number:{required:!0},serial_number:{required:!0},model:{required:!0},year:{required:!0,number:!0},plate:{required:!0}}};Common.validator($("#modal form"),a)})}function r(){Common.success("Vehículo actualizado con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),c.ajax.reload()}function d(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:l,extras:$(this).data("id")})}function l(e){$.ajax({url:"/admin/vehicle/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),c.ajax.reload()},error:Common.eHandler})}var c,m={error:Common.eHandler,rules:{dependency_id:{required:!0},economic_number:{required:!0},serial_number:{required:!0},model:{required:!0},year:{required:!0,number:!0},plate:{required:!0}}};return{init:function(){e(),a(),t($("#submitForm")),o($("#submitForm"))}}}(),VehiclesIn=function(){function e(){m.url="/admin/vehicleIn",m.success=n,Common.validator($("#submitForm"),m),new mPortlet("portlet_1").on("reload",function(){c.ajax.reload()})}function a(){var e=[{data:"vehicle.economic_number",title:"Vehículo"},{data:"department.name",title:"Departamento"},{data:"reason",title:"Razón de entrada"},{data:"requires_refection",title:"Requiere refacción"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];c=Common.remoteTable($("#table"),"/admin/vehicleIn/datatable",e),c.on("click",'[data-action="edit"]',i),c.on("click",'[data-action="delete"]',d)}function t(e){return $.get("/admin/vehicleIn/vehicles",function(a){a.data||!a.error?(e.find("#vehicle_id_input").html("<option></option>"),e.find("#vehicle_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione un vehículo",data:$.map(a.data,function(e){return e.text=e.economic_number,e})})):a.error&&Common.error("Error!",a.r)})}function o(e){return $.get("/admin/vehicleIn/departments",function(a){a.data||!a.error?(e.find("#department_id_input").html("<option></option>"),e.find("#department_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione un departamento",data:$.map(a.data,function(e){return e.text=e.name,e})})):a.error&&Common.error("Error!",a.r)})}function n(e){Common.success("Atencion!","Entrada del vehículo registrado con exito."),c.ajax.reload()}function i(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/vehicleIn/"+e+"/edit").then(function(){var a={url:"/admin/vehicleIn/"+e,success:r,error:Common.eHandler,rules:{reason:{required:!0}}};Common.validator($("#modal form"),a)})}function r(){Common.success("Entrada de vehículo actualizada con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),c.ajax.reload()}function d(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:l,extras:$(this).data("id")})}function l(e){$.ajax({url:"/admin/vehicleIn/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),c.ajax.reload()},error:Common.eHandler})}var c,m={error:Common.eHandler,rules:{vehicle_id:{required:!0},department_id:{required:!0},reason:{required:!0}}};return{init:function(){e(),a(),t($("#submitForm")),o($("#submitForm")),$("#requires_refection_input").bootstrapSwitch()}}}(),VehiclesOut=function(){function e(){c.url="/admin/vehicleOut",c.success=o,Common.validator($("#submitForm"),c),new mPortlet("portlet_1").on("reload",function(){l.ajax.reload()})}function a(){var e=[{data:"vehicle.economic_number",title:"Vehículo"},{data:"reason",title:"Razón de salida"},{data:"is_fixed",title:"Fue reparado"},{data:"created_at",title:"Creado",className:"none",render:Common.dateFormat},{data:"updated_at",title:"Actualizado",render:Common.dateFormat},{data:"p",title:"Acciones",className:"all",render:Common.tableActions}];l=Common.remoteTable($("#table"),"/admin/vehicleOut/datatable",e),l.on("click",'[data-action="edit"]',n),l.on("click",'[data-action="delete"]',r)}function t(e){return $.get("/admin/vehicleOut/vehicles",function(a){a.data||!a.error?(e.find("#vehicle_id_input").html("<option></option>"),e.find("#vehicle_id_input").select2({language:"es",width:"100%",destroy:!0,allowClear:!0,placeholder:"Seleccione un vehículo",data:$.map(a.data,function(e){return e.text=e.economic_number,e})})):a.error&&Common.error("Error!",a.r)})}function o(e){Common.success("Atencion!","Salida del vehículo registrada con exito."),l.ajax.reload()}function n(){var e=$(this).data("id");Common.modal($("#modal"),"/admin/vehicleOut/"+e+"/edit").then(function(){var a={url:"/admin/vehicleOut/"+e,success:i,error:Common.eHandler,rules:{reason:{required:!0}}};Common.validator($("#modal form"),a)})}function i(){Common.success("Salida de vehículo actualizada con exito."),$("#modal").modal("hide"),$("#table").find("a").tooltip("dispose"),l.ajax.reload()}function r(){Common.confirm({title:"¿Seguro que deseas eliminar este registro?",text:"No habrá manera de revertir esta acción",confirmText:"Si, Elimínalo",confirm:d,extras:$(this).data("id")})}function d(e){$.ajax({url:"/admin/vehicleOut/"+e,method:"POST",data:{_token:$("[name='_token']").val(),_method:"DELETE"},dataType:"json",success:function(e){Common.success("Aviso","Registro Eliminado Satisfactoriamente"),l.ajax.reload()},error:Common.eHandler})}var l,c={error:Common.eHandler,rules:{vehicle_id:{required:!0},reason:{required:!0}}};return{init:function(){e(),a(),t($("#submitForm")),$("#is_fixed_input").bootstrapSwitch()}}}();
